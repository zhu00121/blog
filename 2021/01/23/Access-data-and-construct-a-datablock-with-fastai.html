<h2 id="access-data-and-construct-a-datablock-with-fastai">Access data and construct a datablock with fastai</h2>

<p>First of all, we need to set the path to our dataset and read it in with pandas. Here Iâ€™m using a dataframe as an example:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>df = pd.read_csv('filepath')
df.head()
</code></pre></div></div>

<p><img src="C:\Users\richa\AppData\Roaming\Typora\typora-user-images\image-20210123140220632.png" alt="image-20210123140220632" style="zoom: 50%;" /></p>

<p>To access the <code class="language-plaintext highlighter-rouge">fname</code> only, we could use <code class="language-plaintext highlighter-rouge">DataFrame.iloc</code> or <code class="language-plaintext highlighter-rouge">df['fname']</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>df.iloc[:,0]
df['fname']
</code></pre></div></div>

<p><img src="C:\Users\richa\AppData\Roaming\Typora\typora-user-images\image-20210123140818797.png" alt="image-20210123140818797" style="zoom:50%;" /></p>

<p>Now for classification problems, we always want our data labelled and have it divided into training and validation set. The <code class="language-plaintext highlighter-rouge">Datablock</code> object of Fastai can do this automatically for us.</p>

<p>The <code class="language-plaintext highlighter-rouge">Datablock</code> is a generic container to quickly build <code class="language-plaintext highlighter-rouge">Datasets</code> and <code class="language-plaintext highlighter-rouge">DataLoaders</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dblock = Datablock()
dblock?
</code></pre></div></div>

<p><img src="C:\Users\richa\AppData\Roaming\Typora\typora-user-images\image-20210123143154190.png" alt="image-20210123143154190" style="zoom:50%;" /></p>

<p>We could then build a datasets object with a source. With ` .train<code class="language-plaintext highlighter-rouge"> and </code>.valid`, it randomly splits the whole dataset into training set with 80% of data and validation set with 20% of data.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dsets = dblock.datasets(df)
len(dsets.train),len(dsets.valid) #number of training and validation sets
x, y = dsets[0]
x,y
</code></pre></div></div>

<p><img src="C:\Users\richa\AppData\Roaming\Typora\typora-user-images\image-20210123143845530.png" alt="image-20210123143845530" style="zoom:50%;" /></p>

<p>What if we want the file name to be something else and the labels to be split up?</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def get_x(r): return r['fname']
def get_y(r): return r['labels'].split('')
dblock = Datablock(blocks = (ImageBlock,MultiCategoryBlcok)
							,get_x = get_x,get_y = get_y) #To have it opened as image with 																multilabel
dsets = dblock.datasets(df)
dsets.train[0]
</code></pre></div></div>

<p><img src="C:\Users\richa\AppData\Roaming\Typora\typora-user-images\image-20210123162422439.png" alt="image-20210123162422439" style="zoom:50%;" /></p>

<p>Now we can put our <code class="language-plaintext highlighter-rouge">datasets</code>into <code class="language-plaintext highlighter-rouge">dataloaders</code>. What <code class="language-plaintext highlighter-rouge">dataloadesrs</code>does is basically collating the items from <code class="language-plaintext highlighter-rouge">datasets</code>into a mini batch. While we are doing so, we need to also make sure that the images are of the same size.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dblock = Datablock.(blocks(ImageBlock,MultiCategoryBlcok),
				  get_x = get_x,get_y = get_y,
				  item_tfms = RandomResizedCrop(128,min_scale = 0.35))
dls = dblock.Dataloaders(df)
</code></pre></div></div>

<p>Display a few:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dls.show_batch(nrows=3, ncols=3)
</code></pre></div></div>

<p><img src="C:\Users\richa\AppData\Roaming\Typora\typora-user-images\image-20210123163851911.png" alt="image-20210123163851911" style="zoom:67%;" /></p>
